<!DOCTYPE html>
<!-- saved from url=(0012)about:srcdoc -->
<html lang="en" dir="rtl"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
				
				<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<style>
					body {
						background-color: white; /* Ensure the iframe has a white background */
					}
				</style>
				<script>
					const CDN_WHITELIST = [
						'cdn.jsdelivr.net',
						'cdnjs.cloudflare.com',
						'cdn.tailwindcss.com',
						'unpkg.com',
						'fonts.googleapis.com',
						'd3js.org',
						'cdn.babylonjs.com',
						'html2canvas.hertzen.com',
						'code.jquery.com',
						'cdn.datatables.net',
						'kit.fontawesome.com',
						'code.createjs.com',
						'cdn.plot.ly',
						'fonts.gstatic.com',
						'www.rgraph.net',
						'api.mapbox.com',
						'polyfill.io',
						'cdn.quilljs.com',
						'picsum.photos',
						'esm.sh'
					];

					function isUrlInWhitelist(url) {
						if (!url || typeof url !== 'string') {
							return false;
						}
						try {
							const urlObj = new URL(url);
							const hostname = urlObj.hostname;
							return CDN_WHITELIST.some(domain => hostname === domain || hostname.endsWith('.' + domain));
						} catch (e) {
							return false;
						}
					}

					function proxyCdnUrl(url) {
						if (!url || !url.startsWith('http')) {
							return url;
						}
						if (url && (url.startsWith('http://') || url.startsWith('https://')) && !url.startsWith('https://artifacts-cdn.chatglm.site/')) {
							const proxiedUrl = 'https://artifacts-cdn.chatglm.site/' + url;
							return proxiedUrl;
						}
						return url;
					}

					const rawCreateElement = document.createElement;

					document.createElement = function (tagName, ...args) {
						const el = rawCreateElement.call(this, tagName, ...args);

						if (tagName.toLowerCase() === 'script') {
							const rawSetAttribute = el.setAttribute;
							const rawGetAttribute = el.getAttribute;
							let srcValue = '';
							
							el.setAttribute = function (name, value) {
								if (name === 'src' && typeof value === 'string') {
									value = proxyCdnUrl(value);
									srcValue = value;
								}
								return rawSetAttribute.call(this, name, value);
							};

							Object.defineProperty(el, 'src', {
								get: function() {
									return srcValue || rawGetAttribute.call(this, 'src') || '';
								},
								set: function(value) {
									if (typeof value === 'string') {
										srcValue = proxyCdnUrl(value);
										rawSetAttribute.call(this, 'src', srcValue);
									} else {
										srcValue = value;
									}
								},
								configurable: true,
								enumerable: true
							});
						}

						if (tagName.toLowerCase() === 'link') {
							const rawSetAttribute = el.setAttribute;
							const rawGetAttribute = el.getAttribute;
							let hrefValue = '';
							
							el.setAttribute = function (name, value) {
								if (name === 'href' && typeof value === 'string') {
									value = proxyCdnUrl(value);
									hrefValue = value;
								}
								return rawSetAttribute.call(this, name, value);
							};

							Object.defineProperty(el, 'href', {
								get: function() {
									return hrefValue || rawGetAttribute.call(this, 'href') || '';
								},
								set: function(value) {
									if (typeof value === 'string') {
										hrefValue = proxyCdnUrl(value);
										rawSetAttribute.call(this, 'href', hrefValue);
									} else {
										hrefValue = value;
									}
								},
								configurable: true,
								enumerable: true
							});
						}

						return el;
					};

					const OriginalXMLHttpRequest = window.XMLHttpRequest;
					window.XMLHttpRequest = function (...args) {
						const xhr = new OriginalXMLHttpRequest(...args);
						const rawOpen = xhr.open;

						xhr.open = function (method, url, ...rest) {
							if (typeof url === 'string') {
								const methodUpper = (method || '').toUpperCase();
								if (methodUpper === 'GET' && isUrlInWhitelist(url)) {
									url = proxyCdnUrl(url);
								}
							}
							return rawOpen.call(this, method, url, ...rest);
						};

						return xhr;
					};

					window.XMLHttpRequest.prototype = OriginalXMLHttpRequest.prototype;
					Object.setPrototypeOf(window.XMLHttpRequest, OriginalXMLHttpRequest);

					const originalFetch = window.fetch;
					window.fetch = async function (...args) {
						if (args.length > 0) {
							let url = '';
							let method = 'GET';
							
							if (typeof args[0] === 'string') {
								url = args[0];
								if (args[1] && args[1].method) {
									method = args[1].method.toUpperCase();
								}
								if (method === 'GET' && isUrlInWhitelist(url)) {
									args[0] = proxyCdnUrl(url);
								}
							} else if (args[0] instanceof Request) {
								const originalUrl = args[0].url;
								method = (args[0].method || 'GET').toUpperCase();
								if (method === 'GET' && isUrlInWhitelist(originalUrl)) {
									const proxiedUrl = proxyCdnUrl(originalUrl);
									if (proxiedUrl !== originalUrl) {
										args[0] = new Request(proxiedUrl, args[0]);
									}
								}
							}
						}
						return originalFetch.apply(this, args);
					};
				</script>
			</head>
			<body>
				
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام متابعة المؤشرات التربوية - ولاية سليانة</title>
    
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="https://artifacts-cdn.chatglm.site/https://cdn.rtlcss.com/bootstrap/v4.5.3/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://artifacts-cdn.chatglm.site/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #1a5276;
            --secondary-color: #2874a6;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-bg: #f8f9fa;
            --dark-text: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark-text);
        }
        
        .main-header {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .login-container {
            max-width: 500px;
            margin: 5rem auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .login-header {
            background: var(--primary-color);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .login-body {
            padding: 2.5rem;
        }
        
        .form-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .section-title {
            background: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            margin: 2rem 0 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .grade-card {
            background: var(--light-bg);
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .grade-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        
        .grade-title {
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-color);
        }
        
        .gender-section {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .gender-block {
            flex: 1;
            min-width: 200px;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .total-block {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            order: -1;
        }
        
        .gender-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid #ced4da;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        .btn-primary {
            background: var(--primary-color);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 500;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: var(--success-color);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 500;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-success:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .school-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .data-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .table thead th {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .table tbody tr:hover {
            background-color: #f1f8ff;
        }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-complete {
            background: #d4edda;
            color: #155724;
        }
        
        .status-partial {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-missing {
            background: #f8d7da;
            color: #721c24;
        }
        
        .progress-container {
            margin: 2rem 0;
        }
        
        .progress {
            height: 25px;
            border-radius: 15px;
            background: #e9ecef;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--success-color), var(--accent-color));
            font-weight: 500;
        }
        
        .admin-dashboard {
            display: none;
        }
        
        .school-dashboard {
            display: none;
        }
        
        .login-section {
            display: block;
        }
        
        .floating-save {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .floating-save button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem;
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
            border-width: 0.3rem;
        }
        
        .alert-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            min-width: 300px;
        }
        
        .custom-alert {
            padding: 1rem 1.5rem;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .stats-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .stats-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .export-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .excel-preview {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .excel-preview table {
            border-collapse: collapse;
            width: 100%;
            font-size: 0.9rem;
        }
        
        .excel-preview th,
        .excel-preview td {
            border: 1px solid #ddd;
            padding: 0.5rem;
            text-align: center;
        }
        
        .excel-preview th {
            background: var(--primary-color);
            color: white;
            font-weight: 500;
        }
        
        .excel-preview .grade-header {
            background: var(--secondary-color);
        }
        
        @media (max-width: 768px) {
            .gender-section {
                flex-direction: column;
                gap: 1rem;
            }
            
            .school-info {
                text-align: center;
            }
            
            .export-buttons {
                flex-direction: column;
            }
            
            .table-responsive {
                font-size: 0.85rem;
            }
        }
    </style>


    <!-- Alert Container -->
    <div class="alert-container" id="alertContainer"></div>
    
    <!-- Main Header -->
    <header class="main-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="mb-0">
                        <i class="fas fa-graduation-cap ml-2"></i>
                        نظام متابعة المؤشرات التربوية
                    </h1>
                </div>
                <div class="col-md-6 text-md-left">
                    <h4 class="mb-0">ولاية سليانة - السنة الدراسية 2025-2026</h4>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Login Section -->
    <div class="login-section" id="loginSection" style="display: none;">
        <div class="container">
            <div class="login-container">
                <div class="login-header">
                    <h3><i class="fas fa-lock ml-2"></i>تسجيل الدخول</h3>
                    <p>الرجاء إدخال رمز المدرسة وكلمة المرور</p>
                </div>
                <div class="login-body">
                    <form id="loginForm">
                        <div class="form-group mb-4">
                            <label for="schoolCode" class="form-label">
                                <i class="fas fa-school ml-1"></i>رمز المدرسة
                            </label>
                            <select class="form-select" id="schoolCode" required="">
                                <option value="">اختر مدرستك</option>
                            <option value="421001">421001 - م.إ.  البريد</option><option value="421003">421003 - م.إ.  البلهوان</option><option value="421004">421004 - م.إ.  حي الصلاح</option><option value="421012">421012 - م.إ.   جامة</option><option value="421014">421014 - م.إ.  عين الديسة</option><option value="421017">421017 - م.إ.  مديونة</option><option value="421018">421018 - م.إ.  الصاحبين</option><option value="421024">421024 - م.إ. بن زكري يهبـو</option><option value="421025">421025 - م.إ.  دشرة الخلصة</option><option value="421030">421030 - م.إ.  الجوى</option><option value="421031">421031 - م.إ.  عرقوب الخلصة</option><option value="421036">421036 - م.إ.  الخزامي</option><option value="421037">421037 - م.إ.  حي النور-</option><option value="421038">421038 - م.إ.  زواغة</option><option value="421040">421040 - م.إ.الشهداء -</option><option value="421041">421041 - م.إ.  بن زكري</option><option value="421043">421043 - م.إ.  الطيب المهيري</option><option value="421044">421044 - م.إ.  الطويبية</option><option value="421045">421045 - م.إ.  حي النزهة</option><option value="421301">421301 - م.إ.  رأس الماء</option><option value="421302">421302 - م.إ.  سيدي حماده</option><option value="421303">421303 - م.إ.  الغماليــة</option><option value="421304">421304 - م.إ.  القابل</option><option value="421305">421305 - م.إ.  قبر الغول</option><option value="421306">421306 - م.إ.  القنارة</option><option value="421307">421307 - م.إ.  القنطرة</option><option value="421308">421308 - م.إ. مرج مقدم</option><option value="421310">421310 - م.إ.  العذابة</option><option value="421311">421311 - م.إ.  عين القصبات</option><option value="421312">421312 - م.إ.  عرقوب الدبغة</option><option value="421314">421314 - م.إ.  غياضة</option><option value="421315">421315 - م.إ.  حانوت مرزوق</option><option value="421316">421316 - م.إ.  عين أم الحبال</option><option value="421317">421317 - م.إ.  الزريبة</option><option value="421318">421318 - م.إ.  النمايرية</option><option value="421319">421319 - م.إ.  قصر حديد</option><option value="421320">421320 - م.إ.  صنوبرين</option><option value="421321">421321 - م.إ.  سيدي عامر</option><option value="421322">421322 - م.إ.  المرقب</option><option value="421324">421324 - م.إ.  الجمهورية</option><option value="421325">421325 - م.إ.  الحرية</option><option value="421326">421326 - م.إ.حي الأنس</option><option value="421501">421501 - م.إ.  2 مارس</option><option value="421502">421502 - م.إ.  سيدي سعيد</option><option value="421503">421503 - م.إ.  عين بوسعدية</option><option value="421504">421504 - م.إ.  عين زكار</option><option value="421505">421505 - م.إ.  سيدي زيد</option><option value="421506">421506 - م.إ.  صدقة</option><option value="421507">421507 - م.إ.  الدريجة</option><option value="421508">421508 - م.إ.  الكنازيز</option><option value="421510">421510 - م.إ.  مرج عوام</option><option value="421511">421511 - م.إ.  دمان الخرّوب</option><option value="421513">421513 - م.إ.  حي الزهور</option><option value="421514">421514 - م.إ.  أولاد بن عمر</option><option value="421516">421516 - م.إ.  البياض</option><option value="421517">421517 - م.إ.  عين فرنة</option><option value="422001">422001 - م.إ.  الجمهورية</option><option value="422002">422002 - م.إ.  نهج نابل</option><option value="422005">422005 - م.إ.  هنشير فطيـس</option><option value="422006">422006 - م.إ.  محطة الجليدة</option><option value="422007">422007 - م.إ.  قصر بوخريص</option><option value="422008">422008 - م.إ.  طرف الشناء</option><option value="422012">422012 - م.إ.  عين قسيل</option><option value="422014">422014 - م.إ.  أولاد عرفة</option><option value="422015">422015 - م.إ.  حي الزياتين</option><option value="422016">422016 - م.إ.  سيدي عبد النور</option><option value="422017">422017 - م.إ.  بيجقة</option><option value="422018">422018 - م.إ.  هنشير رومان</option><option value="422020">422020 - م.إ.  ابن خلدون بوعرادة</option><option value="422103">422103 - م.إ.   2 مارس 1934</option><option value="422104">422104 - م.إ.  بوجليدة</option><option value="422106">422106 - م.إ.  سيدي عياد</option><option value="422109">422109 - م.إ.  دشرة الحجاج</option><option value="422111">422111 - م.إ.  عين بوسلامة</option><option value="422113">422113 - م.إ.   الرّميــل</option><option value="422119">422119 - م.إ.  وادي العرعار</option><option value="422120">422120 - م.إ. ابن خلدون</option><option value="422501">422501 - م.إ.  شاكر</option><option value="422502">422502 - م.إ.   بورقيبة</option><option value="422503">422503 - محطة الأخوات</option><option value="422504">422504 - م.إ.  منجم الأخوات</option><option value="422508">422508 - م.إ.  الخروبة</option><option value="422511">422511 - م.إ.  الأقصاب</option><option value="422513">422513 - م.إ.  عين زريق</option><option value="422514">422514 - م.إ.  الطيب المهيري</option><option value="422516">422516 - م.إ.  منزل نايل</option><option value="422517">422517 - م.إ.  حي الزهور</option><option value="422518">422518 - م.إ.  بنورية</option><option value="423001">423001 - م.إ.  2 مارس 34 الكريب</option><option value="423002">423002 - م.إ.  حمام بياضة</option><option value="423003">423003 - م.إ. برج مسعودي</option><option value="423004">423004 - م.إ.  حمام السخون</option><option value="423005">423005 - م.إ.  أولاد طالب</option><option value="423007">423007 - م.إ.  عقبة السلوقي</option><option value="423013">423013 - م.إ.  العالية</option><option value="423014">423014 - م.إ.  الدخانية القديمة</option><option value="423015">423015 - م.إ.  مدين</option><option value="423017">423017 - الحبيب بورقيبة</option><option value="423018">423018 - م.إ.  الخنقة</option><option value="423019">423019 - م.إ.  الدخانية الجديدة</option><option value="423020">423020 - م.إ.  عرقوب كلاع</option><option value="423021">423021 - م.إ.  وادي اللوز</option><option value="423022">423022 - م.إ. حي النصر</option><option value="423023">423023 - م.إ.  المهيريس</option><option value="423501">423501 - م.إ.  السّيـادة</option><option value="423502">423502 - م.إ.  حشاد</option><option value="423503">423503 - م.إ.   شاكر</option><option value="423506">423506 - م.إ.  الخيزران</option><option value="423507">423507 - م.إ.  سند الحداد</option><option value="423508">423508 - م.إ.  جوف صدين</option><option value="423510">423510 - م.إ.  حوش الصفايا</option><option value="423512">423512 - م.إ.  بني حازم</option><option value="423514">423514 - م.إ.  القرعة</option><option value="423515">423515 - م.إ.  الشوارنية</option><option value="423517">423517 - م.إ.  رأس الوادي</option><option value="423518">423518 - م.إ.  سوق الجمعة</option><option value="423519">423519 - م.إ.  التلة</option><option value="423522">423522 - م.إ.  صيار</option><option value="423523">423523 - م.إ.  وادي الرمل</option><option value="423524">423524 - م.إ.  الحمادة</option><option value="423525">423525 - م.إ.  أولاد الشيخ</option><option value="423526">423526 - م.إ.  الزواكرة</option><option value="423527">423527 - م.إ.  قصر اللوح</option><option value="423528">423528 - م.إ.  أولاد علي</option><option value="423529">423529 - م.إ.  الحصحاصية</option><option value="423530">423530 - م.إ.  الحذايقية</option><option value="523531">523531 - م.إ.  الزعرورة</option><option value="424001">424001 - م.إ.  2 مارس 34 الروحية</option><option value="424002">424002 - م.إ.  الهرية</option><option value="424003">424003 - م.إ.  فندق دبيش</option><option value="424004">424004 - م.إ.  جلاب القديمة</option><option value="424005">424005 - م.إ.  الحبابسة</option><option value="424006">424006 - م.إ.  أولاد زيتون</option><option value="424007">424007 - م.إ. بوعجيلة</option><option value="424008">424008 - م.إ.  برج دبيش</option><option value="424009">424009 - م.إ.  الباطن</option><option value="424010">424010 - م.إ.  الشوشة</option><option value="424011">424011 - م.إ.  الحميمة</option><option value="424013">424013 - م.إ.  المرثوم</option><option value="424014">424014 - م.إ.  النقاقشة</option><option value="424015">424015 - م.إ.  النجايمية</option><option value="424016">424016 - م.إ.  سيدي مولى</option><option value="424017">424017 - م.إ.حي السعادة</option><option value="424018">424018 - م.إ.  المقرونة</option><option value="424019">424019 - م.إ.  أولاد بلال</option><option value="424020">424020 - م.إ.  الصويوين</option><option value="424021">424021 - م.إ.  السميرات</option><option value="424022">424022 - م.إ. حي النور</option><option value="424023">424023 - م.إ.  الجلاب الجديدة</option><option value="424024">424024 - م.إ.  بربرو</option><option value="424025">424025 - م.إ.  أولاد بلغيث</option><option value="424026">424026 - م.إ.  جلجل</option><option value="424027">424027 - الزقلاص</option><option value="424028">424028 - م.إ.  الدليوات</option><option value="424029">424029 - م.إ.   محطة الكريب</option><option value="424030">424030 - م.إ.  العباسي</option><option value="424031">424031 - م.إ.  النشم</option><option value="424032">424032 - م.إ.  الرويسين القديمة</option><option value="424033">424033 - م.إ.  2 مارس 34</option><option value="424034">424034 - م.إ.  بورويس الفلاحي</option><option value="424035">424035 - م.إ.  التريشة</option><option value="424036">424036 - م.إ.  أولاد يوسف</option><option value="424037">424037 - م.إ.  الحياة</option><option value="424038">424038 - م.إ.ابو القاسم الشابي</option><option value="424039">424039 - م.إ.  الرويسين الجديدة</option><option value="424040">424040 - م.إ.  2 مارس 34  ---</option><option value="424041">424041 - م.إ.  المنصورة القديمة</option><option value="424042">424042 - م.إ.  القرية الجنوبية</option><option value="424043">424043 - م.إ.  الحمام</option><option value="424044">424044 - م.إ.  بوعبدالله</option><option value="424045">424045 - م.إ.  الفضول</option><option value="424046">424046 - م.إ.  اللوزة القديمة</option><option value="424047">424047 - فرحات حشاد</option><option value="424048">424048 - م.إ.  اللوزة الجديدة</option><option value="424049">424049 - م.إ.  ذواودة كسرى</option><option value="424050">424050 - م.إ.  كسرى الجديدة</option><option value="424051">424051 - م.إ.  القرية الشمالية</option><option value="424052">424052 - م.إ.  أولاد بوعافية</option><option value="424053">424053 - م.إ.  جنوة كسرى</option></select>
                        </div>
                        <div class="form-group mb-4">
                            <label for="password" class="form-label">
                                <i class="fas fa-key ml-1"></i>كلمة المرور
                            </label>
                            <input type="password" class="form-control" id="password" required="">
                            <small class="form-text text-muted">كلمة المرور هي: رمز المدرسة</small>
                        </div>
                        <div class="form-check mb-4">
                            <input type="checkbox" class="form-check-input" id="adminLogin">
                            <label class="form-check-label" for="adminLogin">
                                دخول كمدير عام
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary btn-lg btn-block">
                            <i class="fas fa-sign-in-alt ml-2"></i>دخول
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- School Dashboard -->
    <div class="school-dashboard" id="schoolDashboard" style="display: block;">
        <div class="container">
            <!-- School Info -->
            <div class="school-info">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h2 id="schoolName">م.إ.  البريد</h2>
                        <p id="schoolDelegation">المعتمدية: سليانة الشمالية - الرمز: 421001</p>
                    </div>
                    <div class="col-md-4 text-md-left">
                        <button class="btn btn-light" onclick="logout()">
                            <i class="fas fa-sign-out-alt ml-2"></i>تسجيل خروج
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-container">
                <h5>مستوى إكمال البيانات</h5>
                <div class="progress">
                    <div class="progress-bar" id="progressBar" role="progressbar" style="width: 62%;">62%</div>
                </div>
            </div>
            
            <!-- Data Form -->
            <form id="dataForm">
                <!-- Section 1: Academic Achievement -->
                <div class="section-title">
                    <i class="fas fa-chart-line"></i>
                    تجويد مكتسبات التلاميذ إناثا و ذكورا بالمرحلة الابتدائية 
                    <span class="badge badge-light ml-2">(عدد التلاميذ المتحصلين على معدل 10 فما فوق في الثلاثي الاول)</span>
                </div>
                
                <div id="achievementGrades"><div class="grade-card">
                        <div class="grade-title">التحضيري</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_التحضيري_total" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_التحضيري_f_count" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_التحضيري_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_التحضيري_m_count" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_التحضيري_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الأولى</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_الأولى_total" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الأولى_f_count" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الأولى_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الأولى_m_count" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الأولى_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الثانية</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_الثانية_total" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الثانية_f_count" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الثانية_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الثانية_m_count" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الثانية_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الثالثة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_الثالثة_total" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الثالثة_f_count" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الثالثة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الثالثة_m_count" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الثالثة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الرابعة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_الرابعة_total" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الرابعة_f_count" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الرابعة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الرابعة_m_count" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الرابعة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الخامسة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_الخامسة_total" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الخامسة_f_count" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الخامسة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_الخامسة_m_count" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_الخامسة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">السادسة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_السادسة_total" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;ach&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_السادسة_f_count" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_السادسة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_السادسة_m_count" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;ach&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_السادسة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div></div>
                
                <!-- Section 2: Dropouts -->
                <div class="section-title">
                    <i class="fas fa-user-times"></i>
                    الانقطاع الى غاية 2025/12/20
                </div>
                
                <div class="grade-card">
                    <div class="grade-title">العدد الجملي للانقطاع</div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">العدد الكلي</label>
                            <input type="number" class="form-control" id="totalDropouts" min="0">
                        </div>
                    </div>
                </div>
                
                <div id="dropoutGrades"><div class="grade-card">
                        <div class="grade-title">التحضيري</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_التحضيري_total" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_التحضيري_f_count" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_التحضيري_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_التحضيري_m_count" min="0" onchange="calculatePercentage(&#39;التحضيري&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_التحضيري_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الأولى</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_الأولى_total" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الأولى_f_count" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الأولى_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الأولى_m_count" min="0" onchange="calculatePercentage(&#39;الأولى&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الأولى_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الثانية</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_الثانية_total" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الثانية_f_count" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الثانية_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الثانية_m_count" min="0" onchange="calculatePercentage(&#39;الثانية&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الثانية_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الثالثة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_الثالثة_total" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الثالثة_f_count" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الثالثة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الثالثة_m_count" min="0" onchange="calculatePercentage(&#39;الثالثة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الثالثة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الرابعة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_الرابعة_total" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الرابعة_f_count" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الرابعة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الرابعة_m_count" min="0" onchange="calculatePercentage(&#39;الرابعة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الرابعة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">الخامسة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_الخامسة_total" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الخامسة_f_count" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الخامسة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_الخامسة_m_count" min="0" onchange="calculatePercentage(&#39;الخامسة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_الخامسة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><div class="grade-card">
                        <div class="grade-title">السادسة</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_السادسة_total" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;drop&#39;)" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_السادسة_f_count" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_السادسة_f_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_السادسة_m_count" min="0" onchange="calculatePercentage(&#39;السادسة&#39;, &#39;drop&#39;)">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_السادسة_m_percent" min="0" max="100" step="0.1" readonly="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div></div>
                
                <div class="grade-card">
                    <div class="grade-title">أسباب الانقطاع</div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">الاسباب المباشرة للانقطاع</label>
                            <textarea class="form-control" id="directReasons" rows="3"></textarea>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">الاسباب الغير المباشرة للانقطاع</label>
                            <textarea class="form-control" id="indirectReasons" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Section 3: Absences -->
                <div class="section-title">
                    <i class="fas fa-calendar-times"></i>
                    عدد ايام غيابات التلاميذ و الأطر الى غاية 2025/01/04
                </div>
                
                <div class="grade-card">
                    <div class="grade-title">غيابات التلاميذ</div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">عدد ايام غيابات التلاميذ المبررة</label>
                            <input type="number" class="form-control" id="justifiedAbsences" min="0">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">عدد ايام غيابات التلاميذ غير المبررة</label>
                            <input type="number" class="form-control" id="unjustifiedAbsences" min="0">
                        </div>
                    </div>
                </div>
                
                <div class="grade-card">
                    <div class="grade-title">غيابات الأطر</div>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">عدد ايام غيابات اطار التدريس</label>
                            <input type="number" class="form-control" id="teachingStaffAbsences" min="0">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">عدد ايام غيابات الاطار الاداري</label>
                            <input type="number" class="form-control" id="adminStaffAbsences" min="0">
                        </div>
                    </div>
                </div>
                
                <!-- Floating Save Button -->
                <div class="floating-save">
                    <button type="submit" class="btn btn-success btn-lg rounded-circle">
                        <i class="fas fa-save"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Admin Dashboard -->
    <div class="admin-dashboard" id="adminDashboard" style="display: none;">
        <div class="container">
            <!-- Admin Header -->
            <div class="school-info">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h2>لوحة تحكم المدير العام</h2>
                        <p>عرض وتصدير بيانات جميع المدارس</p>
                    </div>
                    <div class="col-md-4 text-md-left">
                        <button class="btn btn-light" onclick="logout()">
                            <i class="fas fa-sign-out-alt ml-2"></i>تسجيل خروج
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-icon text-primary">
                            <i class="fas fa-school"></i>
                        </div>
                        <div class="stats-number" id="totalSchools">179</div>
                        <div>إجمالي المدارس</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card text-success">
                        <div class="stats-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stats-number" id="completedSchools">1</div>
                        <div>أكملت البيانات</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card text-warning">
                        <div class="stats-icon">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div class="stats-number" id="partialSchools">0</div>
                        <div>بيانات جزئية</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card text-danger">
                        <div class="stats-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="stats-number" id="missingSchools">178</div>
                        <div>لم تبدأ بعد</div>
                    </div>
                </div>
            </div>
            
            <!-- Export Buttons -->
            <div class="export-buttons">
                <button class="btn btn-primary" onclick="exportToExcel()">
                    <i class="fas fa-file-excel ml-2"></i>تصدير إلى Excel
                </button>
                <button class="btn btn-success" onclick="printReport()">
                    <i class="fas fa-print ml-2"></i>طباعة التقرير
                </button>
                <button class="btn btn-info" onclick="refreshData()">
                    <i class="fas fa-sync-alt ml-2"></i>تحديث البيانات
                </button>
            </div>
            
            <!-- Data Table -->
            <div class="data-table">
                <div class="table-responsive">
                    <table class="table table-hover table-sm" id="schoolsTable">
                        <thead>
                            <tr>
                                <th>الرمز</th>
                                <th>المعتمدية</th>
                                <th>المدرسة</th>
                                <th>مستوى الإكمال</th>
                                <th>آخر تحديث</th>
                                <th>إجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="schoolsTableBody"><tr>
                    <td>421001</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  البريد</td>
                    <td>
                        <span class="status-badge status-partial">جزئي (93%)</span>
                    </td>
                    <td>12‏/1‏/2026 10:40:19 ص</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421001&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421003</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  البلهوان</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421003&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421004</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  حي الصلاح</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421004&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421012</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.   جامة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421012&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421014</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  عين الديسة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421014&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421017</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  مديونة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421017&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421018</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الصاحبين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421018&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421024</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ. بن زكري يهبـو</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421024&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421025</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  دشرة الخلصة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421025&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421030</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الجوى</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421030&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421031</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  عرقوب الخلصة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421031&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421036</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الخزامي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421036&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421037</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  حي النور-</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421037&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421038</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  زواغة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421038&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421040</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.الشهداء -</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421040&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421041</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  بن زكري</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421041&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421043</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الطيب المهيري</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421043&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421044</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الطويبية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421044&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421045</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  حي النزهة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421045&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421301</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  رأس الماء</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421301&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421302</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  سيدي حماده</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421302&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421303</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  الغماليــة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421303&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421304</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  القابل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421304&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421305</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  قبر الغول</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421305&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421306</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  القنارة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421306&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421307</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  القنطرة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421307&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421308</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ. مرج مقدم</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421308&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421310</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  العذابة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421310&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421311</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  عين القصبات</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421311&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421312</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  عرقوب الدبغة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421312&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421314</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  غياضة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421314&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421315</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  حانوت مرزوق</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421315&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421316</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  عين أم الحبال</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421316&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421317</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  الزريبة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421317&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421318</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  النمايرية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421318&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421319</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  قصر حديد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421319&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421320</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  صنوبرين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421320&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421321</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  سيدي عامر</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421321&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421322</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  المرقب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421322&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421324</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  الجمهورية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421324&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421325</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.  الحرية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421325&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421326</td>
                    <td>سليانة الجنوبية</td>
                    <td>م.إ.حي الأنس</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421326&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421501</td>
                    <td>برقو</td>
                    <td>م.إ.  2 مارس</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421501&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421502</td>
                    <td>برقو</td>
                    <td>م.إ.  سيدي سعيد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421502&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421503</td>
                    <td>برقو</td>
                    <td>م.إ.  عين بوسعدية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421503&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421504</td>
                    <td>برقو</td>
                    <td>م.إ.  عين زكار</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421504&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421505</td>
                    <td>برقو</td>
                    <td>م.إ.  سيدي زيد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421505&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421506</td>
                    <td>برقو</td>
                    <td>م.إ.  صدقة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421506&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421507</td>
                    <td>برقو</td>
                    <td>م.إ.  الدريجة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421507&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421508</td>
                    <td>برقو</td>
                    <td>م.إ.  الكنازيز</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421508&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421510</td>
                    <td>برقو</td>
                    <td>م.إ.  مرج عوام</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421510&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421511</td>
                    <td>برقو</td>
                    <td>م.إ.  دمان الخرّوب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421511&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421513</td>
                    <td>برقو</td>
                    <td>م.إ.  حي الزهور</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421513&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421514</td>
                    <td>برقو</td>
                    <td>م.إ.  أولاد بن عمر</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421514&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421516</td>
                    <td>برقو</td>
                    <td>م.إ.  البياض</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421516&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>421517</td>
                    <td>برقو</td>
                    <td>م.إ.  عين فرنة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;421517&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422001</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  الجمهورية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422001&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422002</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  نهج نابل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422002&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422005</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  هنشير فطيـس</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422005&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422006</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  محطة الجليدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422006&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422007</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  قصر بوخريص</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422007&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422008</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  طرف الشناء</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422008&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422012</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  عين قسيل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422012&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422014</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  أولاد عرفة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422014&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422015</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  حي الزياتين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422015&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422016</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  سيدي عبد النور</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422016&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422017</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  بيجقة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422017&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422018</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  هنشير رومان</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422018&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422020</td>
                    <td>بوعرادة</td>
                    <td>م.إ.  ابن خلدون بوعرادة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422020&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422103</td>
                    <td>العروسة</td>
                    <td>م.إ.   2 مارس 1934</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422103&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422104</td>
                    <td>العروسة</td>
                    <td>م.إ.  بوجليدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422104&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422106</td>
                    <td>العروسة</td>
                    <td>م.إ.  سيدي عياد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422106&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422109</td>
                    <td>العروسة</td>
                    <td>م.إ.  دشرة الحجاج</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422109&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422111</td>
                    <td>العروسة</td>
                    <td>م.إ.  عين بوسلامة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422111&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422113</td>
                    <td>العروسة</td>
                    <td>م.إ.   الرّميــل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422113&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422119</td>
                    <td>العروسة</td>
                    <td>م.إ.  وادي العرعار</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422119&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422120</td>
                    <td>العروسة</td>
                    <td>م.إ. ابن خلدون</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422120&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422501</td>
                    <td>فعفور</td>
                    <td>م.إ.  شاكر</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422501&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422502</td>
                    <td>فعفور</td>
                    <td>م.إ.   بورقيبة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422502&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422503</td>
                    <td>فعفور</td>
                    <td>محطة الأخوات</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422503&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422504</td>
                    <td>فعفور</td>
                    <td>م.إ.  منجم الأخوات</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422504&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422508</td>
                    <td>فعفور</td>
                    <td>م.إ.  الخروبة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422508&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422511</td>
                    <td>فعفور</td>
                    <td>م.إ.  الأقصاب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422511&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422513</td>
                    <td>فعفور</td>
                    <td>م.إ.  عين زريق</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422513&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422514</td>
                    <td>فعفور</td>
                    <td>م.إ.  الطيب المهيري</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422514&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422516</td>
                    <td>فعفور</td>
                    <td>م.إ.  منزل نايل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422516&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422517</td>
                    <td>فعفور</td>
                    <td>م.إ.  حي الزهور</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422517&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>422518</td>
                    <td>فعفور</td>
                    <td>م.إ.  بنورية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;422518&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423001</td>
                    <td>الكريب</td>
                    <td>م.إ.  2 مارس 34 الكريب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423001&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423002</td>
                    <td>الكريب</td>
                    <td>م.إ.  حمام بياضة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423002&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423003</td>
                    <td>الكريب</td>
                    <td>م.إ. برج مسعودي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423003&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423004</td>
                    <td>الكريب</td>
                    <td>م.إ.  حمام السخون</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423004&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423005</td>
                    <td>الكريب</td>
                    <td>م.إ.  أولاد طالب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423005&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423007</td>
                    <td>الكريب</td>
                    <td>م.إ.  عقبة السلوقي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423007&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423013</td>
                    <td>الكريب</td>
                    <td>م.إ.  العالية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423013&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423014</td>
                    <td>الكريب</td>
                    <td>م.إ.  الدخانية القديمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423014&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423015</td>
                    <td>الكريب</td>
                    <td>م.إ.  مدين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423015&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423017</td>
                    <td>الكريب</td>
                    <td>الحبيب بورقيبة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423017&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423018</td>
                    <td>الكريب</td>
                    <td>م.إ.  الخنقة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423018&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423019</td>
                    <td>الكريب</td>
                    <td>م.إ.  الدخانية الجديدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423019&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423020</td>
                    <td>الكريب</td>
                    <td>م.إ.  عرقوب كلاع</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423020&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423021</td>
                    <td>الكريب</td>
                    <td>م.إ.  وادي اللوز</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423021&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423022</td>
                    <td>الكريب</td>
                    <td>م.إ. حي النصر</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423022&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423023</td>
                    <td>الكريب</td>
                    <td>م.إ.  المهيريس</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423023&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423501</td>
                    <td>مكثر</td>
                    <td>م.إ.  السّيـادة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423501&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423502</td>
                    <td>مكثر</td>
                    <td>م.إ.  حشاد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423502&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423503</td>
                    <td>مكثر</td>
                    <td>م.إ.   شاكر</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423503&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423506</td>
                    <td>مكثر</td>
                    <td>م.إ.  الخيزران</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423506&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423507</td>
                    <td>مكثر</td>
                    <td>م.إ.  سند الحداد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423507&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423508</td>
                    <td>مكثر</td>
                    <td>م.إ.  جوف صدين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423508&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423510</td>
                    <td>مكثر</td>
                    <td>م.إ.  حوش الصفايا</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423510&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423512</td>
                    <td>مكثر</td>
                    <td>م.إ.  بني حازم</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423512&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423514</td>
                    <td>مكثر</td>
                    <td>م.إ.  القرعة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423514&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423515</td>
                    <td>مكثر</td>
                    <td>م.إ.  الشوارنية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423515&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423517</td>
                    <td>مكثر</td>
                    <td>م.إ.  رأس الوادي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423517&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423518</td>
                    <td>مكثر</td>
                    <td>م.إ.  سوق الجمعة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423518&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423519</td>
                    <td>مكثر</td>
                    <td>م.إ.  التلة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423519&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423522</td>
                    <td>مكثر</td>
                    <td>م.إ.  صيار</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423522&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423523</td>
                    <td>مكثر</td>
                    <td>م.إ.  وادي الرمل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423523&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423524</td>
                    <td>مكثر</td>
                    <td>م.إ.  الحمادة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423524&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423525</td>
                    <td>مكثر</td>
                    <td>م.إ.  أولاد الشيخ</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423525&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423526</td>
                    <td>مكثر</td>
                    <td>م.إ.  الزواكرة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423526&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423527</td>
                    <td>مكثر</td>
                    <td>م.إ.  قصر اللوح</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423527&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423528</td>
                    <td>مكثر</td>
                    <td>م.إ.  أولاد علي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423528&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423529</td>
                    <td>مكثر</td>
                    <td>م.إ.  الحصحاصية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423529&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>423530</td>
                    <td>مكثر</td>
                    <td>م.إ.  الحذايقية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;423530&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>523531</td>
                    <td>مكثر</td>
                    <td>م.إ.  الزعرورة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;523531&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424001</td>
                    <td>الروحية</td>
                    <td>م.إ.  2 مارس 34 الروحية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424001&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424002</td>
                    <td>الروحية</td>
                    <td>م.إ.  الهرية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424002&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424003</td>
                    <td>الروحية</td>
                    <td>م.إ.  فندق دبيش</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424003&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424004</td>
                    <td>الروحية</td>
                    <td>م.إ.  جلاب القديمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424004&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424005</td>
                    <td>الروحية</td>
                    <td>م.إ.  الحبابسة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424005&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424006</td>
                    <td>الروحية</td>
                    <td>م.إ.  أولاد زيتون</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424006&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424007</td>
                    <td>الروحية</td>
                    <td>م.إ. بوعجيلة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424007&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424008</td>
                    <td>الروحية</td>
                    <td>م.إ.  برج دبيش</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424008&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424009</td>
                    <td>الروحية</td>
                    <td>م.إ.  الباطن</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424009&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424010</td>
                    <td>الروحية</td>
                    <td>م.إ.  الشوشة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424010&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424011</td>
                    <td>الروحية</td>
                    <td>م.إ.  الحميمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424011&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424013</td>
                    <td>الروحية</td>
                    <td>م.إ.  المرثوم</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424013&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424014</td>
                    <td>الروحية</td>
                    <td>م.إ.  النقاقشة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424014&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424015</td>
                    <td>الروحية</td>
                    <td>م.إ.  النجايمية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424015&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424016</td>
                    <td>الروحية</td>
                    <td>م.إ.  سيدي مولى</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424016&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424017</td>
                    <td>الروحية</td>
                    <td>م.إ.حي السعادة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424017&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424018</td>
                    <td>الروحية</td>
                    <td>م.إ.  المقرونة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424018&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424019</td>
                    <td>الروحية</td>
                    <td>م.إ.  أولاد بلال</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424019&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424020</td>
                    <td>الروحية</td>
                    <td>م.إ.  الصويوين</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424020&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424021</td>
                    <td>الروحية</td>
                    <td>م.إ.  السميرات</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424021&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424022</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ. حي النور</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424022&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424023</td>
                    <td>الروحية</td>
                    <td>م.إ.  الجلاب الجديدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424023&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424024</td>
                    <td>الروحية</td>
                    <td>م.إ.  بربرو</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424024&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424025</td>
                    <td>الروحية</td>
                    <td>م.إ.  أولاد بلغيث</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424025&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424026</td>
                    <td>الروحية</td>
                    <td>م.إ.  جلجل</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424026&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424027</td>
                    <td>الروحية</td>
                    <td>الزقلاص</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424027&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424028</td>
                    <td>الروحية</td>
                    <td>م.إ.  الدليوات</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424028&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424029</td>
                    <td>الكريب</td>
                    <td>م.إ.   محطة الكريب</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424029&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424030</td>
                    <td>الكريب</td>
                    <td>م.إ.  العباسي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424030&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424031</td>
                    <td>الكريب</td>
                    <td>م.إ.  النشم</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424031&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424032</td>
                    <td>الروحية</td>
                    <td>م.إ.  الرويسين القديمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424032&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424033</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  2 مارس 34</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424033&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424034</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  بورويس الفلاحي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424034&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424035</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  التريشة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424035&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424036</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  أولاد يوسف</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424036&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424037</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.  الحياة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424037&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424038</td>
                    <td>سليانة الشمالية</td>
                    <td>م.إ.ابو القاسم الشابي</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424038&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424039</td>
                    <td>الروحية</td>
                    <td>م.إ.  الرويسين الجديدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424039&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424040</td>
                    <td>الروحية</td>
                    <td>م.إ.  2 مارس 34  ---</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424040&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424041</td>
                    <td>الروحية</td>
                    <td>م.إ.  المنصورة القديمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424041&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424042</td>
                    <td>الروحية</td>
                    <td>م.إ.  القرية الجنوبية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424042&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424043</td>
                    <td>الروحية</td>
                    <td>م.إ.  الحمام</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424043&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424044</td>
                    <td>الروحية</td>
                    <td>م.إ.  بوعبدالله</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424044&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424045</td>
                    <td>الروحية</td>
                    <td>م.إ.  الفضول</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424045&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424046</td>
                    <td>الروحية</td>
                    <td>م.إ.  اللوزة القديمة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424046&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424047</td>
                    <td>الروحية</td>
                    <td>فرحات حشاد</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424047&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424048</td>
                    <td>الروحية</td>
                    <td>م.إ.  اللوزة الجديدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424048&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424049</td>
                    <td>الروحية</td>
                    <td>م.إ.  ذواودة كسرى</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424049&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424050</td>
                    <td>الروحية</td>
                    <td>م.إ.  كسرى الجديدة</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424050&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424051</td>
                    <td>الروحية</td>
                    <td>م.إ.  القرية الشمالية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424051&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424052</td>
                    <td>الروحية</td>
                    <td>م.إ.  أولاد بوعافية</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424052&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr><tr>
                    <td>424053</td>
                    <td>الروحية</td>
                    <td>م.إ.  جنوة كسرى</td>
                    <td>
                        <span class="status-badge status-missing">لم تبدأ (0%)</span>
                    </td>
                    <td>لم يتم التحديث</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable(&#39;424053&#39;)">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                </tr></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Excel Preview Modal -->
            <div class="excel-preview" id="excelPreview" style="display: block;">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4>جدول بيانات المدرسة</h4>
                    <button class="btn btn-secondary" onclick="closeExcelPreview()">
                        <i class="fas fa-times ml-2"></i>إغلاق
                    </button>
                </div>
                <div id="excelPreviewContent">
                <h5 class="text-center mb-3">م.إ.  البريد - سليانة الشمالية</h5>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th colspan="3" class="text-center">معلومات المدرسة</th>
                            <th colspan="21" class="text-center grade-header">بيانات التحصيل الدراسي</th>
                            <th colspan="21" class="text-center grade-header">بيانات الانقطاع</th>
                            <th colspan="7" class="text-center">الغيابات والأسباب</th>
                        </tr>
                        <tr>
                            <th>الرمز</th>
                            <th>المعتمدية</th>
                            <th>المدرسة</th>
            <th colspan="3">التحضيري</th><th colspan="3">الأولى</th><th colspan="3">الثانية</th><th colspan="3">الثالثة</th><th colspan="3">الرابعة</th><th colspan="3">الخامسة</th><th colspan="3">السادسة</th><th colspan="3">التحضيري</th><th colspan="3">الأولى</th><th colspan="3">الثانية</th><th colspan="3">الثالثة</th><th colspan="3">الرابعة</th><th colspan="3">الخامسة</th><th colspan="3">السادسة</th>
                            <th>مباشرة</th>
                            <th>غير مباشرة</th>
                            <th>مبررة</th>
                            <th>غير مبررة</th>
                            <th>التدريس</th>
                            <th>الإداري</th>
                        </tr>
                        <tr>
                            <th colspan="3"></th>
            <th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th><th>الجملي</th><th>إناث</th><th>ذكور</th>
                            <th></th><th></th><th></th><th></th><th></th><th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>421001</td>
                            <td>سليانة الشمالية</td>
                            <td>م.إ.  البريد</td>
            
                            <td>30</td>
                            <td>13</td>
                            <td>15</td>
                    
                            <td>30</td>
                            <td>10</td>
                            <td>10</td>
                    
                            <td>25</td>
                            <td>12</td>
                            <td>10</td>
                    
                            <td>30</td>
                            <td>10</td>
                            <td>10</td>
                    
                            <td>33</td>
                            <td>12</td>
                            <td>15</td>
                    
                            <td>30</td>
                            <td>15</td>
                            <td>8</td>
                    
                            <td>25</td>
                            <td>10</td>
                            <td>0</td>
                    <td>1</td>
                            <td>20</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>30</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>25</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>30</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>33</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>30</td>
                            <td>0</td>
                            <td>0</td>
                    
                            <td>25</td>
                            <td>1</td>
                            <td>0</td>
                    
                            <td>لا شيء</td>
                            <td>لا شيء</td>
            
                            <td>10</td>
                            <td>20</td>
                            <td>10</td>
                            <td>0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>
            
            <!-- Loading Spinner -->
            <div class="loading-spinner" id="loadingSpinner">
                <div class="spinner-border text-primary" role="status">
                    <span class="sr-only">جاري التحميل...</span>
                </div>
                <p class="mt-3">جاري تحميل البيانات...</p>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://artifacts-cdn.chatglm.site/https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://artifacts-cdn.chatglm.site/https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://artifacts-cdn.chatglm.site/https://cdn.rtlcss.com/bootstrap/v4.5.3/js/bootstrap.min.js"></script>
    
    <script>
        // Complete Schools Data - All 193 schools from the provided list
        const schoolsData = [
            // سليانة الشمالية
            {code: "421001", name: "م.إ.  البريد", delegation: "سليانة الشمالية"},
            {code: "421003", name: "م.إ.  البلهوان", delegation: "سليانة الشمالية"},
            {code: "421004", name: "م.إ.  حي الصلاح", delegation: "سليانة الشمالية"},
            {code: "421012", name: "م.إ.   جامة", delegation: "سليانة الشمالية"},
            {code: "421014", name: "م.إ.  عين الديسة", delegation: "سليانة الشمالية"},
            {code: "421017", name: "م.إ.  مديونة", delegation: "سليانة الشمالية"},
            {code: "421018", name: "م.إ.  الصاحبين", delegation: "سليانة الشمالية"},
            {code: "421024", name: "م.إ. بن زكري يهبـو", delegation: "سليانة الشمالية"},
            {code: "421025", name: "م.إ.  دشرة الخلصة", delegation: "سليانة الشمالية"},
            {code: "421030", name: "م.إ.  الجوى", delegation: "سليانة الشمالية"},
            {code: "421031", name: "م.إ.  عرقوب الخلصة", delegation: "سليانة الشمالية"},
            {code: "421036", name: "م.إ.  الخزامي", delegation: "سليانة الشمالية"},
            {code: "421037", name: "م.إ.  حي النور-", delegation: "سليانة الشمالية"},
            {code: "421038", name: "م.إ.  زواغة", delegation: "سليانة الشمالية"},
            {code: "421040", name: "م.إ.الشهداء -", delegation: "سليانة الشمالية"},
            {code: "421041", name: "م.إ.  بن زكري", delegation: "سليانة الشمالية"},
            {code: "421043", name: "م.إ.  الطيب المهيري", delegation: "سليانة الشمالية"},
            {code: "421044", name: "م.إ.  الطويبية", delegation: "سليانة الشمالية"},
            {code: "421045", name: "م.إ.  حي النزهة", delegation: "سليانة الشمالية"},
            
            // سليانة الجنوبية
            {code: "421301", name: "م.إ.  رأس الماء", delegation: "سليانة الجنوبية"},
            {code: "421302", name: "م.إ.  سيدي حماده", delegation: "سليانة الجنوبية"},
            {code: "421303", name: "م.إ.  الغماليــة", delegation: "سليانة الجنوبية"},
            {code: "421304", name: "م.إ.  القابل", delegation: "سليانة الجنوبية"},
            {code: "421305", name: "م.إ.  قبر الغول", delegation: "سليانة الجنوبية"},
            {code: "421306", name: "م.إ.  القنارة", delegation: "سليانة الجنوبية"},
            {code: "421307", name: "م.إ.  القنطرة", delegation: "سليانة الجنوبية"},
            {code: "421308", name: "م.إ. مرج مقدم", delegation: "سليانة الجنوبية"},
            {code: "421310", name: "م.إ.  العذابة", delegation: "سليانة الجنوبية"},
            {code: "421311", name: "م.إ.  عين القصبات", delegation: "سليانة الجنوبية"},
            {code: "421312", name: "م.إ.  عرقوب الدبغة", delegation: "سليانة الجنوبية"},
            {code: "421314", name: "م.إ.  غياضة", delegation: "سليانة الجنوبية"},
            {code: "421315", name: "م.إ.  حانوت مرزوق", delegation: "سليانة الجنوبية"},
            {code: "421316", name: "م.إ.  عين أم الحبال", delegation: "سليانة الجنوبية"},
            {code: "421317", name: "م.إ.  الزريبة", delegation: "سليانة الجنوبية"},
            {code: "421318", name: "م.إ.  النمايرية", delegation: "سليانة الجنوبية"},
            {code: "421319", name: "م.إ.  قصر حديد", delegation: "سليانة الجنوبية"},
            {code: "421320", name: "م.إ.  صنوبرين", delegation: "سليانة الجنوبية"},
            {code: "421321", name: "م.إ.  سيدي عامر", delegation: "سليانة الجنوبية"},
            {code: "421322", name: "م.إ.  المرقب", delegation: "سليانة الجنوبية"},
            {code: "421324", name: "م.إ.  الجمهورية", delegation: "سليانة الجنوبية"},
            {code: "421325", name: "م.إ.  الحرية", delegation: "سليانة الجنوبية"},
            {code: "421326", name: "م.إ.حي الأنس", delegation: "سليانة الجنوبية"},
            
            // برقو
            {code: "421501", name: "م.إ.  2 مارس", delegation: "برقو"},
            {code: "421502", name: "م.إ.  سيدي سعيد", delegation: "برقو"},
            {code: "421503", name: "م.إ.  عين بوسعدية", delegation: "برقو"},
            {code: "421504", name: "م.إ.  عين زكار", delegation: "برقو"},
            {code: "421505", name: "م.إ.  سيدي زيد", delegation: "برقو"},
            {code: "421506", name: "م.إ.  صدقة", delegation: "برقو"},
            {code: "421507", name: "م.إ.  الدريجة", delegation: "برقو"},
            {code: "421508", name: "م.إ.  الكنازيز", delegation: "برقو"},
            {code: "421510", name: "م.إ.  مرج عوام", delegation: "برقو"},
            {code: "421511", name: "م.إ.  دمان الخرّوب", delegation: "برقو"},
            {code: "421513", name: "م.إ.  حي الزهور", delegation: "برقو"},
            {code: "421514", name: "م.إ.  أولاد بن عمر", delegation: "برقو"},
            {code: "421516", name: "م.إ.  البياض", delegation: "برقو"},
            {code: "421517", name: "م.إ.  عين فرنة", delegation: "برقو"},
            
            // بوعرادة
            {code: "422001", name: "م.إ.  الجمهورية", delegation: "بوعرادة"},
            {code: "422002", name: "م.إ.  نهج نابل", delegation: "بوعرادة"},
            {code: "422005", name: "م.إ.  هنشير فطيـس", delegation: "بوعرادة"},
            {code: "422006", name: "م.إ.  محطة الجليدة", delegation: "بوعرادة"},
            {code: "422007", name: "م.إ.  قصر بوخريص", delegation: "بوعرادة"},
            {code: "422008", name: "م.إ.  طرف الشناء", delegation: "بوعرادة"},
            {code: "422012", name: "م.إ.  عين قسيل", delegation: "بوعرادة"},
            {code: "422014", name: "م.إ.  أولاد عرفة", delegation: "بوعرادة"},
            {code: "422015", name: "م.إ.  حي الزياتين", delegation: "بوعرادة"},
            {code: "422016", name: "م.إ.  سيدي عبد النور", delegation: "بوعرادة"},
            {code: "422017", name: "م.إ.  بيجقة", delegation: "بوعرادة"},
            {code: "422018", name: "م.إ.  هنشير رومان", delegation: "بوعرادة"},
            {code: "422020", name: "م.إ.  ابن خلدون بوعرادة", delegation: "بوعرادة"},
            
            // العروسة
            {code: "422103", name: "م.إ.   2 مارس 1934", delegation: "العروسة"},
            {code: "422104", name: "م.إ.  بوجليدة", delegation: "العروسة"},
            {code: "422106", name: "م.إ.  سيدي عياد", delegation: "العروسة"},
            {code: "422109", name: "م.إ.  دشرة الحجاج", delegation: "العروسة"},
            {code: "422111", name: "م.إ.  عين بوسلامة", delegation: "العروسة"},
            {code: "422113", name: "م.إ.   الرّميــل", delegation: "العروسة"},
            {code: "422119", name: "م.إ.  وادي العرعار", delegation: "العروسة"},
            {code: "422120", name: "م.إ. ابن خلدون", delegation: "العروسة"},
            
            // فعفور
            {code: "422501", name: "م.إ.  شاكر", delegation: "فعفور"},
            {code: "422502", name: "م.إ.   بورقيبة", delegation: "فعفور"},
            {code: "422503", name: "محطة الأخوات", delegation: "فعفور"},
            {code: "422504", name: "م.إ.  منجم الأخوات", delegation: "فعفور"},
            {code: "422508", name: "م.إ.  الخروبة", delegation: "فعفور"},
            {code: "422511", name: "م.إ.  الأقصاب", delegation: "فعفور"},
            {code: "422513", name: "م.إ.  عين زريق", delegation: "فعفور"},
            {code: "422514", name: "م.إ.  الطيب المهيري", delegation: "فعفور"},
            {code: "422516", name: "م.إ.  منزل نايل", delegation: "فعفور"},
            {code: "422517", name: "م.إ.  حي الزهور", delegation: "فعفور"},
            {code: "422518", name: "م.إ.  بنورية", delegation: "فعفور"},
            
            // الكريب
            {code: "423001", name: "م.إ.  2 مارس 34 الكريب", delegation: "الكريب"},
            {code: "423002", name: "م.إ.  حمام بياضة", delegation: "الكريب"},
            {code: "423003", name: "م.إ. برج مسعودي", delegation: "الكريب"},
            {code: "423004", name: "م.إ.  حمام السخون", delegation: "الكريب"},
            {code: "423005", name: "م.إ.  أولاد طالب", delegation: "الكريب"},
            {code: "423007", name: "م.إ.  عقبة السلوقي", delegation: "الكريب"},
            {code: "423013", name: "م.إ.  العالية", delegation: "الكريب"},
            {code: "423014", name: "م.إ.  الدخانية القديمة", delegation: "الكريب"},
            {code: "423015", name: "م.إ.  مدين", delegation: "الكريب"},
            {code: "423017", name: "الحبيب بورقيبة", delegation: "الكريب"},
            {code: "423018", name: "م.إ.  الخنقة", delegation: "الكريب"},
            {code: "423019", name: "م.إ.  الدخانية الجديدة", delegation: "الكريب"},
            {code: "423020", name: "م.إ.  عرقوب كلاع", delegation: "الكريب"},
            {code: "423021", name: "م.إ.  وادي اللوز", delegation: "الكريب"},
            {code: "423022", name: "م.إ. حي النصر", delegation: "الكريب"},
            {code: "423023", name: "م.إ.  المهيريس", delegation: "الكريب"},
            
            // مكثر
            {code: "423501", name: "م.إ.  السّيـادة", delegation: "مكثر"},
            {code: "423502", name: "م.إ.  حشاد", delegation: "مكثر"},
            {code: "423503", name: "م.إ.   شاكر", delegation: "مكثر"},
            {code: "423506", name: "م.إ.  الخيزران", delegation: "مكثر"},
            {code: "423507", name: "م.إ.  سند الحداد", delegation: "مكثر"},
            {code: "423508", name: "م.إ.  جوف صدين", delegation: "مكثر"},
            {code: "423510", name: "م.إ.  حوش الصفايا", delegation: "مكثر"},
            {code: "423512", name: "م.إ.  بني حازم", delegation: "مكثر"},
            {code: "423514", name: "م.إ.  القرعة", delegation: "مكثر"},
            {code: "423515", name: "م.إ.  الشوارنية", delegation: "مكثر"},
            {code: "423517", name: "م.إ.  رأس الوادي", delegation: "مكثر"},
            {code: "423518", name: "م.إ.  سوق الجمعة", delegation: "مكثر"},
            {code: "423519", name: "م.إ.  التلة", delegation: "مكثر"},
            {code: "423522", name: "م.إ.  صيار", delegation: "مكثر"},
            {code: "423523", name: "م.إ.  وادي الرمل", delegation: "مكثر"},
            {code: "423524", name: "م.إ.  الحمادة", delegation: "مكثر"},
            {code: "423525", name: "م.إ.  أولاد الشيخ", delegation: "مكثر"},
            {code: "423526", name: "م.إ.  الزواكرة", delegation: "مكثر"},
            {code: "423527", name: "م.إ.  قصر اللوح", delegation: "مكثر"},
            {code: "423528", name: "م.إ.  أولاد علي", delegation: "مكثر"},
            {code: "423529", name: "م.إ.  الحصحاصية", delegation: "مكثر"},
            {code: "423530", name: "م.إ.  الحذايقية", delegation: "مكثر"},
            {code: "523531", name: "م.إ.  الزعرورة", delegation: "مكثر"},
            
            // الروحية
            {code: "424001", name: "م.إ.  2 مارس 34 الروحية", delegation: "الروحية"},
            {code: "424002", name: "م.إ.  الهرية", delegation: "الروحية"},
            {code: "424003", name: "م.إ.  فندق دبيش", delegation: "الروحية"},
            {code: "424004", name: "م.إ.  جلاب القديمة", delegation: "الروحية"},
            {code: "424005", name: "م.إ.  الحبابسة", delegation: "الروحية"},
            {code: "424006", name: "م.إ.  أولاد زيتون", delegation: "الروحية"},
            {code: "424007", name: "م.إ. بوعجيلة", delegation: "الروحية"},
            {code: "424008", name: "م.إ.  برج دبيش", delegation: "الروحية"},
            {code: "424009", name: "م.إ.  الباطن", delegation: "الروحية"},
            {code: "424010", name: "م.إ.  الشوشة", delegation: "الروحية"},
            {code: "424011", name: "م.إ.  الحميمة", delegation: "الروحية"},
            {code: "424013", name: "م.إ.  المرثوم", delegation: "الروحية"},
            {code: "424014", name: "م.إ.  النقاقشة", delegation: "الروحية"},
            {code: "424015", name: "م.إ.  النجايمية", delegation: "الروحية"},
            {code: "424016", name: "م.إ.  سيدي مولى", delegation: "الروحية"},
            {code: "424017", name: "م.إ.حي السعادة", delegation: "الروحية"},
            {code: "424018", name: "م.إ.  المقرونة", delegation: "الروحية"},
            {code: "424019", name: "م.إ.  أولاد بلال", delegation: "الروحية"},
            {code: "424020", name: "م.إ.  الصويوين", delegation: "الروحية"},
            {code: "424021", name: "م.إ.  السميرات", delegation: "الروحية"},
            
            // المدارس الإضافية
            {code: "424022", name: "م.إ. حي النور", delegation: "سليانة الشمالية"},
            {code: "424023", name: "م.إ.  الجلاب الجديدة", delegation: "الروحية"},
            {code: "424024", name: "م.إ.  بربرو", delegation: "الروحية"},
            {code: "424025", name: "م.إ.  أولاد بلغيث", delegation: "الروحية"},
            {code: "424026", name: "م.إ.  جلجل", delegation: "الروحية"},
            {code: "424027", name: "الزقلاص", delegation: "الروحية"},
            {code: "424028", name: "م.إ.  الدليوات", delegation: "الروحية"},
            {code: "424029", name: "م.إ.   محطة الكريب", delegation: "الكريب"},
            {code: "424030", name: "م.إ.  العباسي", delegation: "الكريب"},
            {code: "424031", name: "م.إ.  النشم", delegation: "الكريب"},
            {code: "424032", name: "م.إ.  الرويسين القديمة", delegation: "الروحية"},
            {code: "424033", name: "م.إ.  2 مارس 34", delegation: "سليانة الشمالية"},
            {code: "424034", name: "م.إ.  بورويس الفلاحي", delegation: "سليانة الشمالية"},
            {code: "424035", name: "م.إ.  التريشة", delegation: "سليانة الشمالية"},
            {code: "424036", name: "م.إ.  أولاد يوسف", delegation: "سليانة الشمالية"},
            {code: "424037", name: "م.إ.  الحياة", delegation: "سليانة الشمالية"},
            {code: "424038", name: "م.إ.ابو القاسم الشابي", delegation: "سليانة الشمالية"},
            {code: "424039", name: "م.إ.  الرويسين الجديدة", delegation: "الروحية"},
            {code: "424040", name: "م.إ.  2 مارس 34  ---", delegation: "الروحية"},
            {code: "424041", name: "م.إ.  المنصورة القديمة", delegation: "الروحية"},
            {code: "424042", name: "م.إ.  القرية الجنوبية", delegation: "الروحية"},
            {code: "424043", name: "م.إ.  الحمام", delegation: "الروحية"},
            {code: "424044", name: "م.إ.  بوعبدالله", delegation: "الروحية"},
            {code: "424045", name: "م.إ.  الفضول", delegation: "الروحية"},
            {code: "424046", name: "م.إ.  اللوزة القديمة", delegation: "الروحية"},
            {code: "424047", name: "فرحات حشاد", delegation: "الروحية"},
            {code: "424048", name: "م.إ.  اللوزة الجديدة", delegation: "الروحية"},
            {code: "424049", name: "م.إ.  ذواودة كسرى", delegation: "الروحية"},
            {code: "424050", name: "م.إ.  كسرى الجديدة", delegation: "الروحية"},
            {code: "424051", name: "م.إ.  القرية الشمالية", delegation: "الروحية"},
            {code: "424052", name: "م.إ.  أولاد بوعافية", delegation: "الروحية"},
            {code: "424053", name: "م.إ.  جنوة كسرى", delegation: "الروحية"}
        ];
        
        // Grades for Achievement Section
        const achievementGrades = [
            "التحضيري", "الأولى", "الثانية", "الثالثة", "الرابعة", "الخامسة", "السادسة"
        ];
        
        // Grades for Dropout Section (including التحضيري)
        const dropoutGrades = [
            "التحضيري", "الأولى", "الثانية", "الثالثة", "الرابعة", "الخامسة", "السادسة"
        ];
        
        // Current School Data
        let currentSchool = null;
        let schoolData = {};
        let allSchoolsData = {}; // Store all schools data locally
        
        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing app...');
            console.log('Schools data length:', schoolsData.length);
            populateSchoolSelect();
            setupEventListeners();
            generateFormFields();
            loadStoredData();
        });
        
        // Populate School Select
        function populateSchoolSelect() {
            const select = document.getElementById('schoolCode');
            console.log('Populating school select...');
            
            if (!select) {
                console.error('School select element not found!');
                return;
            }
            
            // Clear existing options except the first one
            while (select.children.length > 1) {
                select.removeChild(select.lastChild);
            }
            
            schoolsData.forEach((school, index) => {
                const option = document.createElement('option');
                option.value = school.code;
                option.textContent = `${school.code} - ${school.name}`;
                select.appendChild(option);
            });
            
            console.log(`Added ${schoolsData.length} schools to select`);
        }
        
        // Setup Event Listeners
        function setupEventListeners() {
            // Login Form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleLogin();
                });
            }
            
            // Data Form
            const dataForm = document.getElementById('dataForm');
            if (dataForm) {
                dataForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    saveSchoolData();
                });
            }
        }
        
        // Generate Form Fields
        function generateFormFields() {
            // Achievement Grades
            const achievementContainer = document.getElementById('achievementGrades');
            if (achievementContainer) {
                achievementGrades.forEach(grade => {
                    const gradeCard = document.createElement('div');
                    gradeCard.className = 'grade-card';
                    gradeCard.innerHTML = `
                        <div class="grade-title">${grade}</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="ach_${grade}_total" min="0" onchange="calculatePercentage('${grade}', 'ach')" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_${grade}_f_count" min="0" onchange="calculatePercentage('${grade}', 'ach')">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_${grade}_f_percent" min="0" max="100" step="0.1" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="ach_${grade}_m_count" min="0" onchange="calculatePercentage('${grade}', 'ach')">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="ach_${grade}_m_percent" min="0" max="100" step="0.1" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    achievementContainer.appendChild(gradeCard);
                });
            }
            
            // Dropout Grades (now includes التحضيري)
            const dropoutContainer = document.getElementById('dropoutGrades');
            if (dropoutContainer) {
                dropoutGrades.forEach(grade => {
                    const gradeCard = document.createElement('div');
                    gradeCard.className = 'grade-card';
                    gradeCard.innerHTML = `
                        <div class="grade-title">${grade}</div>
                        <div class="gender-section">
                            <div class="total-block">
                                <div class="gender-label">
                                    <i class="fas fa-calculator text-white"></i> العدد الجملي
                                </div>
                                <input type="number" class="form-control" id="drop_${grade}_total" min="0" onchange="calculatePercentage('${grade}', 'drop')" style="background: rgba(255,255,255,0.9); color: var(--primary-color); font-weight: bold;">
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-female text-danger"></i> إناث
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_${grade}_f_count" min="0" onchange="calculatePercentage('${grade}', 'drop')">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_${grade}_f_percent" min="0" max="100" step="0.1" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="gender-block">
                                <div class="gender-label">
                                    <i class="fas fa-male text-primary"></i> ذكور
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">العدد</label>
                                        <input type="number" class="form-control" id="drop_${grade}_m_count" min="0" onchange="calculatePercentage('${grade}', 'drop')">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">النسبة %</label>
                                        <input type="number" class="form-control" id="drop_${grade}_m_percent" min="0" max="100" step="0.1" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    dropoutContainer.appendChild(gradeCard);
                });
            }
        }
        
        // Calculate percentage based on counts and total
        function calculatePercentage(grade, type) {
            const fCount = parseInt(document.getElementById(`${type}_${grade}_f_count`)?.value) || 0;
            const mCount = parseInt(document.getElementById(`${type}_${grade}_m_count`)?.value) || 0;
            const total = parseInt(document.getElementById(`${type}_${grade}_total`)?.value) || 0;
            
            // Calculate percentages if total is not zero
            if (total > 0) {
                const fPercent = ((fCount / total) * 100).toFixed(1);
                const mPercent = ((mCount / total) * 100).toFixed(1);
                
                const fPercentInput = document.getElementById(`${type}_${grade}_f_percent`);
                const mPercentInput = document.getElementById(`${type}_${grade}_m_percent`);
                
                if (fPercentInput) fPercentInput.value = fPercent;
                if (mPercentInput) mPercentInput.value = mPercent;
            } else {
                // Clear percentages if total is zero
                const fPercentInput = document.getElementById(`${type}_${grade}_f_percent`);
                const mPercentInput = document.getElementById(`${type}_${grade}_m_percent`);
                
                if (fPercentInput) fPercentInput.value = '';
                if (mPercentInput) mPercentInput.value = '';
            }
        }
        
        // Load stored data from localStorage
        function loadStoredData() {
            const stored = localStorage.getItem('schoolsData');
            if (stored) {
                try {
                    allSchoolsData = JSON.parse(stored);
                    console.log('Loaded stored data for', Object.keys(allSchoolsData).length, 'schools');
                } catch (e) {
                    console.error('Error loading stored data:', e);
                    allSchoolsData = {};
                }
            }
        }
        
        // Save data to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('schoolsData', JSON.stringify(allSchoolsData));
        }
        
        // Handle Login
        function handleLogin() {
            const schoolCode = document.getElementById('schoolCode').value;
            const password = document.getElementById('password').value;
            const isAdmin = document.getElementById('adminLogin').checked;
            
            if (!schoolCode || !password) {
                showAlert('الرجاء إدخال جميع الحقول', 'warning');
                return;
            }
            
            if (isAdmin) {
                if (password === 'admin123') {
                    showAdminDashboard();
                } else {
                    showAlert('كلمة مرور المدير غير صحيحة', 'danger');
                }
            } else {
                if (password === schoolCode) { // Changed from '123456' to school code
                    currentSchool = schoolsData.find(s => s.code === schoolCode);
                    if (currentSchool) {
                        showSchoolDashboard();
                        loadSchoolData();
                    } else {
                        showAlert('المدرسة غير موجودة', 'danger');
                    }
                } else {
                    showAlert('كلمة المرور غير صحيحة', 'danger');
                }
            }
        }
        
        // Show School Dashboard
        function showSchoolDashboard() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('schoolDashboard').style.display = 'block';
            document.getElementById('schoolName').textContent = currentSchool.name;
            document.getElementById('schoolDelegation').textContent = `المعتمدية: ${currentSchool.delegation} - الرمز: ${currentSchool.code}`;
        }
        
        // Show Admin Dashboard
        function showAdminDashboard() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
            loadAllSchoolsData();
        }
        
        // Load School Data
        function loadSchoolData() {
            schoolData = allSchoolsData[currentSchool.code] || {};
            populateForm();
            updateProgress();
        }
        
        // Populate Form with Data
        function populateForm() {
            // Achievement Data
            achievementGrades.forEach(grade => {
                if (schoolData.achievement && schoolData.achievement[grade]) {
                    const fCount = document.getElementById(`ach_${grade}_f_count`);
                    const fPercent = document.getElementById(`ach_${grade}_f_percent`);
                    const mCount = document.getElementById(`ach_${grade}_m_count`);
                    const mPercent = document.getElementById(`ach_${grade}_m_percent`);
                    const total = document.getElementById(`ach_${grade}_total`);
                    
                    if (fCount) fCount.value = schoolData.achievement[grade].female.count || '';
                    if (fPercent) fPercent.value = schoolData.achievement[grade].female.percentage || '';
                    if (mCount) mCount.value = schoolData.achievement[grade].male.count || '';
                    if (mPercent) mPercent.value = schoolData.achievement[grade].male.percentage || '';
                    if (total) total.value = schoolData.achievement[grade].total || '';
                }
            });
            
            // Dropout Data
            const totalDropouts = document.getElementById('totalDropouts');
            if (totalDropouts) totalDropouts.value = schoolData.totalDropouts || '';
            
            dropoutGrades.forEach(grade => {
                if (schoolData.dropoutGrades && schoolData.dropoutGrades[grade]) {
                    const fCount = document.getElementById(`drop_${grade}_f_count`);
                    const fPercent = document.getElementById(`drop_${grade}_f_percent`);
                    const mCount = document.getElementById(`drop_${grade}_m_count`);
                    const mPercent = document.getElementById(`drop_${grade}_m_percent`);
                    const total = document.getElementById(`drop_${grade}_total`);
                    
                    if (fCount) fCount.value = schoolData.dropoutGrades[grade].female.count || '';
                    if (fPercent) fPercent.value = schoolData.dropoutGrades[grade].female.percentage || '';
                    if (mCount) mCount.value = schoolData.dropoutGrades[grade].male.count || '';
                    if (mPercent) mPercent.value = schoolData.dropoutGrades[grade].male.percentage || '';
                    if (total) total.value = schoolData.dropoutGrades[grade].total || '';
                }
            });
            
            const directReasons = document.getElementById('directReasons');
            const indirectReasons = document.getElementById('indirectReasons');
            if (directReasons) directReasons.value = schoolData.directReasons || '';
            if (indirectReasons) indirectReasons.value = schoolData.indirectReasons || '';
            
            // Absence Data
            const justifiedAbsences = document.getElementById('justifiedAbsences');
            const unjustifiedAbsences = document.getElementById('unjustifiedAbsences');
            const teachingStaffAbsences = document.getElementById('teachingStaffAbsences');
            const adminStaffAbsences = document.getElementById('adminStaffAbsences');
            
            if (justifiedAbsences) justifiedAbsences.value = schoolData.justifiedAbsences || '';
            if (unjustifiedAbsences) unjustifiedAbsences.value = schoolData.unjustifiedAbsences || '';
            if (teachingStaffAbsences) teachingStaffAbsences.value = schoolData.teachingStaffAbsences || '';
            if (adminStaffAbsences) adminStaffAbsences.value = schoolData.adminStaffAbsences || '';
        }
        
        // Save School Data
        function saveSchoolData() {
            // Collect Achievement Data
            const achievement = {};
            achievementGrades.forEach(grade => {
                const fCount = document.getElementById(`ach_${grade}_f_count`);
                const fPercent = document.getElementById(`ach_${grade}_f_percent`);
                const mCount = document.getElementById(`ach_${grade}_m_count`);
                const mPercent = document.getElementById(`ach_${grade}_m_percent`);
                const total = document.getElementById(`ach_${grade}_total`);
                
                achievement[grade] = {
                    female: {
                        count: parseInt(fCount?.value) || 0,
                        percentage: parseFloat(fPercent?.value) || 0
                    },
                    male: {
                        count: parseInt(mCount?.value) || 0,
                        percentage: parseFloat(mPercent?.value) || 0
                    },
                    total: parseInt(total?.value) || 0
                };
            });
            
            // Collect Dropout Data
            const dropoutGradesData = {};
            dropoutGrades.forEach(grade => {
                const fCount = document.getElementById(`drop_${grade}_f_count`);
                const fPercent = document.getElementById(`drop_${grade}_f_percent`);
                const mCount = document.getElementById(`drop_${grade}_m_count`);
                const mPercent = document.getElementById(`drop_${grade}_m_percent`);
                const total = document.getElementById(`drop_${grade}_total`);
                
                dropoutGradesData[grade] = {
                    female: {
                        count: parseInt(fCount?.value) || 0,
                        percentage: parseFloat(fPercent?.value) || 0
                    },
                    male: {
                        count: parseInt(mCount?.value) || 0,
                        percentage: parseFloat(mPercent?.value) || 0
                    },
                    total: parseInt(total?.value) || 0
                };
            });
            
            // Prepare Data Object
            const dataToSave = {
                schoolCode: currentSchool.code,
                schoolName: currentSchool.name,
                delegation: currentSchool.delegation,
                achievement: achievement,
                totalDropouts: parseInt(document.getElementById('totalDropouts')?.value) || 0,
                dropoutGrades: dropoutGradesData,
                directReasons: document.getElementById('directReasons')?.value || '',
                indirectReasons: document.getElementById('indirectReasons')?.value || '',
                justifiedAbsences: parseInt(document.getElementById('justifiedAbsences')?.value) || 0,
                unjustifiedAbsences: parseInt(document.getElementById('unjustifiedAbsences')?.value) || 0,
                teachingStaffAbsences: parseInt(document.getElementById('teachingStaffAbsences')?.value) || 0,
                adminStaffAbsences: parseInt(document.getElementById('adminStaffAbsences')?.value) || 0,
                lastUpdated: new Date().toISOString()
            };
            
            // Save to localStorage
            allSchoolsData[currentSchool.code] = dataToSave;
            saveToLocalStorage();
            
            showAlert('تم حفظ البيانات بنجاح', 'success');
            updateProgress();
        }
        
        // Update Progress Bar
        function updateProgress() {
            let filledFields = 0;
            let totalFields = 0;
            
            // Count Achievement Fields
            achievementGrades.forEach(grade => {
                ['f', 'm'].forEach(gender => {
                    totalFields += 2; // count and percentage
                    if (document.getElementById(`ach_${grade}_${gender}_count`)?.value) filledFields++;
                    if (document.getElementById(`ach_${grade}_${gender}_percent`)?.value) filledFields++;
                });
                totalFields += 1; // total
                if (document.getElementById(`ach_${grade}_total`)?.value) filledFields++;
            });
            
            // Count Dropout Fields
            totalFields += 1; // total dropouts
            if (document.getElementById('totalDropouts')?.value) filledFields++;
            
            dropoutGrades.forEach(grade => {
                ['f', 'm'].forEach(gender => {
                    totalFields += 2;
                    if (document.getElementById(`drop_${grade}_${gender}_count`)?.value) filledFields++;
                    if (document.getElementById(`drop_${grade}_${gender}_percent`)?.value) filledFields++;
                });
                totalFields += 1; // total
                if (document.getElementById(`drop_${grade}_total`)?.value) filledFields++;
            });
            
            // Count Reason Fields
            totalFields += 2;
            if (document.getElementById('directReasons')?.value) filledFields++;
            if (document.getElementById('indirectReasons')?.value) filledFields++;
            
            // Count Absence Fields
            totalFields += 4;
            if (document.getElementById('justifiedAbsences')?.value) filledFields++;
            if (document.getElementById('unjustifiedAbsences')?.value) filledFields++;
            if (document.getElementById('teachingStaffAbsences')?.value) filledFields++;
            if (document.getElementById('adminStaffAbsences')?.value) filledFields++;
            
            const percentage = Math.round((filledFields / totalFields) * 100);
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
                progressBar.textContent = percentage + '%';
            }
        }
        
        // Load All Schools Data (Admin)
        function loadAllSchoolsData() {
            populateSchoolsTable();
            updateStatistics();
        }
        
        // Populate Schools Table (Admin)
        function populateSchoolsTable() {
            const tbody = document.getElementById('schoolsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            schoolsData.forEach(school => {
                const schoolData = allSchoolsData[school.code] || {};
                const lastUpdated = schoolData.lastUpdated ? new Date(schoolData.lastUpdated).toLocaleString('ar-TN') : 'لم يتم التحديث';
                
                // Calculate completion percentage
                let completion = 0;
                if (schoolData.achievement) {
                    let filled = 0;
                    let total = 0;
                    
                    achievementGrades.forEach(grade => {
                        if (schoolData.achievement[grade]) {
                            if (schoolData.achievement[grade].female.count > 0) filled++;
                            if (schoolData.achievement[grade].male.count > 0) filled++;
                            total += 2;
                        }
                    });
                    
                    if (total > 0) completion = Math.round((filled / total) * 100);
                }
                
                let statusClass = 'status-missing';
                let statusText = 'لم تبدأ';
                
                if (completion === 100) {
                    statusClass = 'status-complete';
                    statusText = 'مكتمل';
                } else if (completion > 0) {
                    statusClass = 'status-partial';
                    statusText = 'جزئي';
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${school.code}</td>
                    <td>${school.delegation}</td>
                    <td>${school.name}</td>
                    <td>
                        <span class="status-badge ${statusClass}">${statusText} (${completion}%)</span>
                    </td>
                    <td>${lastUpdated}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewSchoolExcelTable('${school.code}')">
                            <i class="fas fa-table"></i> عرض جدول
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // Update Statistics (Admin)
        function updateStatistics() {
            let total = schoolsData.length;
            let completed = 0;
            let partial = 0;
            let missing = 0;
            
            schoolsData.forEach(school => {
                const schoolData = allSchoolsData[school.code] || {};
                let hasData = false;
                
                if (schoolData.achievement) {
                    achievementGrades.forEach(grade => {
                        if (schoolData.achievement[grade]) {
                            if (schoolData.achievement[grade].female.count > 0 || 
                                schoolData.achievement[grade].male.count > 0) {
                                hasData = true;
                            }
                        }
                    });
                }
                
                if (hasData) {
                    // Check if all grades have data
                    let allGradesHaveData = true;
                    achievementGrades.forEach(grade => {
                        if (!schoolData.achievement[grade] || 
                            (schoolData.achievement[grade].female.count === 0 && 
                             schoolData.achievement[grade].male.count === 0)) {
                            allGradesHaveData = false;
                        }
                    });
                    
                    if (allGradesHaveData) {
                        completed++;
                    } else {
                        partial++;
                    }
                } else {
                    missing++;
                }
            });
            
            const totalSchoolsEl = document.getElementById('totalSchools');
            const completedSchoolsEl = document.getElementById('completedSchools');
            const partialSchoolsEl = document.getElementById('partialSchools');
            const missingSchoolsEl = document.getElementById('missingSchools');
            
            if (totalSchoolsEl) totalSchoolsEl.textContent = total;
            if (completedSchoolsEl) completedSchoolsEl.textContent = completed;
            if (partialSchoolsEl) partialSchoolsEl.textContent = partial;
            if (missingSchoolsEl) missingSchoolsEl.textContent = missing;
        }
        
        // View School Excel Table (Admin) - New function
        function viewSchoolExcelTable(schoolCode) {
            const school = schoolsData.find(s => s.code === schoolCode);
            const data = allSchoolsData[schoolCode] || {};
            
            if (!school) {
                showAlert('المدرسة غير موجودة', 'danger');
                return;
            }
            
            // Generate HTML table for the school
            let tableHTML = `
                <h5 class="text-center mb-3">${school.name} - ${school.delegation}</h5>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th colspan="3" class="text-center">معلومات المدرسة</th>
                            <th colspan="21" class="text-center grade-header">بيانات التحصيل الدراسي</th>
                            <th colspan="21" class="text-center grade-header">بيانات الانقطاع</th>
                            <th colspan="7" class="text-center">الغيابات والأسباب</th>
                        </tr>
                        <tr>
                            <th>الرمز</th>
                            <th>المعتمدية</th>
                            <th>المدرسة</th>
            `;
            
            // Achievement headers
            achievementGrades.forEach(grade => {
                tableHTML += `<th colspan="3">${grade}</th>`;
            });
            
            // Dropout headers
            dropoutGrades.forEach(grade => {
                tableHTML += `<th colspan="3">${grade}</th>`;
            });
            
            // Other headers
            tableHTML += `
                            <th>مباشرة</th>
                            <th>غير مباشرة</th>
                            <th>مبررة</th>
                            <th>غير مبررة</th>
                            <th>التدريس</th>
                            <th>الإداري</th>
                        </tr>
                        <tr>
                            <th colspan="3"></th>
            `;
            
            // Achievement sub-headers
            achievementGrades.forEach(() => {
                tableHTML += '<th>الجملي</th><th>إناث</th><th>ذكور</th>';
            });
            
            // Dropout sub-headers
            dropoutGrades.forEach(() => {
                tableHTML += '<th>الجملي</th><th>إناث</th><th>ذكور</th>';
            });
            
            // Other sub-headers
            tableHTML += `
                            <th></th><th></th><th></th><th></th><th></th><th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>${school.code}</td>
                            <td>${school.delegation}</td>
                            <td>${school.name}</td>
            `;
            
            // Achievement data
            achievementGrades.forEach(grade => {
                if (data.achievement && data.achievement[grade]) {
                    tableHTML += `
                            <td>${data.achievement[grade].total || 0}</td>
                            <td>${data.achievement[grade].female.count || 0}</td>
                            <td>${data.achievement[grade].male.count || 0}</td>
                    `;
                } else {
                    tableHTML += '<td>0</td><td>0</td><td>0</td>';
                }
            });
            
            // Total dropouts
            tableHTML += `<td>${data.totalDropouts || 0}</td>`;
            
            // Dropout data
            dropoutGrades.forEach(grade => {
                if (data.dropoutGrades && data.dropoutGrades[grade]) {
                    tableHTML += `
                            <td>${data.dropoutGrades[grade].total || 0}</td>
                            <td>${data.dropoutGrades[grade].female.count || 0}</td>
                            <td>${data.dropoutGrades[grade].male.count || 0}</td>
                    `;
                } else {
                    tableHTML += '<td>0</td><td>0</td><td>0</td>';
                }
            });
            
            // Reasons
            tableHTML += `
                            <td>${data.directReasons || ''}</td>
                            <td>${data.indirectReasons || ''}</td>
            `;
            
            // Absences
            tableHTML += `
                            <td>${data.justifiedAbsences || 0}</td>
                            <td>${data.unjustifiedAbsences || 0}</td>
                            <td>${data.teachingStaffAbsences || 0}</td>
                            <td>${data.adminStaffAbsences || 0}</td>
                        </tr>
                    </tbody>
                </table>
            `;
            
            // Display the table
            const previewDiv = document.getElementById('excelPreview');
            const contentDiv = document.getElementById('excelPreviewContent');
            if (previewDiv && contentDiv) {
                contentDiv.innerHTML = tableHTML;
                previewDiv.style.display = 'block';
            }
        }
        
        // Close Excel Preview
        function closeExcelPreview() {
            const previewDiv = document.getElementById('excelPreview');
            if (previewDiv) {
                previewDiv.style.display = 'none';
            }
        }
        
        // Export to Excel (Admin) - Fixed to show actual percentages
        function exportToExcel() {
            let excelContent = '<table>';
            
            // Add header rows
            excelContent += '<tr><td colspan="115" style="text-align:center; font-weight:bold;">متابعة اهم مؤشرات الوضع التربوي لبرنامج المرحلى الابتدائية</td></tr>';
            excelContent += '<tr><td>0</td><td>المعتمدية</td><td>*</td><td>المدرسة الإبتدائية</td><td>*</td><td>*</td><td colspan="109">تجويد مكتسبات التلاميذ إناثا و ذكورا بالمرحلة الابتدائية ( عدد التلاميذ المتحصلين على معدل 10 فما فوق في الثلاثي الاول)</td></tr>';
            
            // New header format - Grade level then total then females then males
            excelContent += '<tr><td>1</td><td>الرمز</td><td>المعتمدية</td><td>*</td><td>الرمز</td><td>المدرسة</td>';
            
            // Achievement headers with new format
            achievementGrades.forEach(grade => {
                excelContent += `<td colspan="5">${grade}</td>`;
            });
            
            // Dropout section
            dropoutGrades.forEach(grade => {
                excelContent += `<td colspan="5">${grade}</td>`;
            });
            
            excelContent += '<td>الاسباب المباشرة للانقطاع</td><td>الاسباب الغيرالمباشرة للانقطاع</td><td colspan="3">عدد ايام غيابات التلاميذ</td><td colspan="2">عدد ايام غيابات اطار التدريس</td></tr>';
            
            // Sub-headers with new format
            excelContent += '<tr><td>2</td><td>*</td><td>*</td><td>*</td><td>*</td><td>*</td>';
            
            achievementGrades.forEach(() => {
                excelContent += '<td>الجملي</td><td colspan="2">إناث</td><td colspan="2">ذكور</td>';
            });
            
            dropoutGrades.forEach(() => {
                excelContent += '<td>الجملي</td><td colspan="2">إناث</td><td colspan="2">ذكور</td>';
            });
            
            excelContent += '<td>*</td><td>*</td><td>مبررة</td><td>غير مبررة</td><td>التدريس</td><td>الاداري</td></tr>';
            
            excelContent += '<tr><td>3</td><td>*</td><td>*</td><td>*</td><td>*</td>';
            
            achievementGrades.forEach(() => {
                excelContent += '<td>العدد</td><td>العدد</td><td>النسبة</td><td>العدد</td><td>النسبة</td>';
            });
            
            dropoutGrades.forEach(() => {
                excelContent += '<td>العدد</td><td>العدد</td><td>النسبة</td><td>العدد</td><td>النسبة</td>';
            });
            
            excelContent += '<td>*</td><td>*</td><td>العدد</td><td>العدد</td><td>العدد</td><td>العدد</td></tr>';
            
            // Data rows for each school
            let startRow = 4;
            schoolsData.forEach((school, index) => {
                const data = allSchoolsData[school.code] || {};
                const rowNum = startRow + index;
                
                excelContent += `<tr><td>${rowNum}</td><td>${school.code}</td><td>${school.delegation}</td><td>*</td><td>${school.code}</td><td>${school.name}`;
                
                // Achievement data with calculated percentages
                achievementGrades.forEach((grade, gradeIndex) => {
                    if (data.achievement && data.achievement[grade]) {
                        const total = data.achievement[grade].total || 0;
                        const fCount = data.achievement[grade].female.count || 0;
                        const mCount = data.achievement[grade].male.count || 0;
                        const fPercent = total > 0 ? ((fCount / total) * 100).toFixed(1) : '0';
                        const mPercent = total > 0 ? ((mCount / total) * 100).toFixed(1) : '0';
                        
                        excelContent += `</td><td>${total}</td>`;
                        excelContent += `<td>${fCount}</td>`;
                        excelContent += `<td>${fPercent}%</td>`;
                        excelContent += `<td>${mCount}</td>`;
                        excelContent += `<td>${mPercent}%</td>`;
                    } else {
                        excelContent += '</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>';
                    }
                });
                
                // Total dropouts
                excelContent += `</td><td>${data.totalDropouts || 0}</td>`;
                
                // Dropout data with calculated percentages
                dropoutGrades.forEach((grade, gradeIndex) => {
                    if (data.dropoutGrades && data.dropoutGrades[grade]) {
                        const total = data.dropoutGrades[grade].total || 0;
                        const fCount = data.dropoutGrades[grade].female.count || 0;
                        const mCount = data.dropoutGrades[grade].male.count || 0;
                        const fPercent = total > 0 ? ((fCount / total) * 100).toFixed(1) : '0';
                        const mPercent = total > 0 ? ((mCount / total) * 100).toFixed(1) : '0';
                        
                        excelContent += `</td><td>${total}</td>`;
                        excelContent += `<td>${fCount}</td>`;
                        excelContent += `<td>${fPercent}%</td>`;
                        excelContent += `<td>${mCount}</td>`;
                        excelContent += `<td>${mPercent}%</td>`;
                    } else {
                        excelContent += '</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>';
                    }
                });
                
                // Reasons
                excelContent += `</td><td>${data.directReasons || ''}</td>`;
                excelContent += `<td>${data.indirectReasons || ''}</td>`;
                
                // Absences
                excelContent += `</td><td>${data.justifiedAbsences || 0}</td>`;
                excelContent += `<td>${data.unjustifiedAbsences || 0}</td>`;
                excelContent += `<td>${data.teachingStaffAbsences || 0}</td>`;
                excelContent += `<td>${data.adminStaffAbsences || 0}</td></tr>`;
            });
            
            excelContent += '</table>';
            
            // Create download link
            const blob = new Blob(['\ufeff' + excelContent], { type: 'application/vnd.ms-excel;charset=utf-8' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `متابعة_مؤشرات_التربوية_سليانة_${new Date().toISOString().split('T')[0]}.xls`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showAlert('تم تصدير البيانات بنجاح مع قيم النسب المئوية', 'success');
        }
        
        // Print Report (Admin)
        function printReport() {
            window.print();
        }
        
        // Refresh Data (Admin)
        function refreshData() {
            loadAllSchoolsData();
            showAlert('تم تحديث البيانات', 'success');
        }
        
        // Logout
        function logout() {
            currentSchool = null;
            schoolData = {};
            
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('schoolDashboard').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
            
            // Reset form
            const loginForm = document.getElementById('loginForm');
            const dataForm = document.getElementById('dataForm');
            if (loginForm) loginForm.reset();
            if (dataForm) dataForm.reset();
            
            showAlert('تم تسجيل الخروج بنجاح', 'success');
        }
        
        // Show Alert
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alert = document.createElement('div');
            alert.className = `custom-alert alert alert-${type} alert-dismissible fade show`;
            alert.innerHTML = `
                ${message}
                <button type="button" class="close" data-dismiss="alert">
                    <span>&times;</span>
                </button>
            `;
            
            alertContainer.appendChild(alert);
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 5000);
        }
    </script>


			
		
</body></html>